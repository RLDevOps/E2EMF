<style>
#timeline-chart g.y{display: none;}
</style>
<script src="js/spin.js"></script>
<!-- widget grid -->
<section id="widget-grid" class="">
<!-- row -->
<div class="row">
<!-- NEW WIDGET START -->
<article class="col-xs-12 col-sm-6 col-md-12 col-lg-12">
<div class="row">
<div class="col-md-3">
<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget jarviswidget-color-light " id="wid-id-1" data-widget-editbutton="false" data-widget-colorbutton="true" data-widget-deletebutton="false" data-widget-fullscreenbutton="false" data-widget-sortable="false">
				<!-- widget options:
					usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
					
					data-widget-colorbutton="false"	
					data-widget-editbutton="false"
					data-widget-togglebutton="false"
					data-widget-deletebutton="false"
					data-widget-fullscreenbutton="false"
					data-widget-custombutton="false"
					data-widget-collapsed="true" 
					data-widget-sortable="false"
					
				-->
				<header>
					<span class="widget-icon"><i class="fa fa-fw fa-bar-chart-o"> </i></span>
					<h2 >PO Types</h2>				
					
				</header>

				<!-- widget div-->
				<div>
					
					<!-- widget edit box -->
					<div class="jarviswidget-editbox">
						<!-- This area used as dropdown edit box -->

					</div>
					<!-- end widget edit box -->
					
					<!-- widget content -->
					<div class="widget-body">
						
						<div id="row-chart">
		
<a class="reset" href="javascript:horzBarChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>
   <div class="clearfix"></div>
				 </div>
						
					</div>
					<!-- end widget content -->
					
				</div>
				<!-- end widget div -->
				
			</div>
			<!-- end widget -->
</div>
<div class="col-md-9">
<!-- Widget ID (each widget will need unique ID)-->
<div class="jarviswidget jarviswidget-color-light " id="wid-id-2" data-widget-editbutton="false" data-widget-colorbutton="true" data-widget-deletebutton="false" data-widget-fullscreenbutton="false"  >
				<!-- widget options:
					usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
					
					data-widget-colorbutton="false"	
					data-widget-editbutton="false"
					data-widget-togglebutton="false"
					data-widget-deletebutton="false"
					data-widget-fullscreenbutton="false"
					data-widget-custombutton="false"
					data-widget-collapsed="true" 
					data-widget-sortable="false"
					
				-->
				<header>
					<span class="widget-icon"><i class="fa fa-fw fa-bar-chart-o"> </i></span>
					<h2>PO Analytics by Dimensions</h2>				
					
				</header>

				<!-- widget div-->
				<div style="background:url('img/main-back.png') repeat scroll 0 0 #FFFFFF">
					
					<!-- widget edit box -->
					<div class="jarviswidget-editbox" >
						<!-- This area used as dropdown edit box -->

					</div>
					<!-- end widget edit box -->
					
					<!-- widget content -->
					<div class="widget-body">
						

			    <!--    <a class="reset" href="javascript:pieChartVendor.filterAll();dc.redrawAll();"
			           style="display: none;">reset</a>		-->
			           <div id="pie-chart-Vendor" class="col-md-4" align="center" >
				        <strong>Vendor</strong>
				        <a class="reset" href="javascript:pieChartVendor.filterAll();dc.redrawAll();" style="display: none;">reset</a>
				
				        <div class="clearfix"></div>
		    		</div>	
			          
			 
			    
				    <div id="pie-chart-plant" class="col-md-4"  align="center">
				        <strong>Plant</strong>
				         <a class="reset" href="javascript:pieChartPlant.filterAll();dc.redrawAll();" style="display: none;">reset</a>
				
				        <div class="clearfix"></div>
		    		</div>	
			        
			          <div id="pie-chart-purchaseorg" class="col-md-4"  align="center">
				        <strong>Purchase Org</strong>
				        <a class="reset" href="javascript:pieChartPurchaseorg.filterAll();dc.redrawAll();" style="display: none;">reset</a>
				
				        <div class="clearfix"></div>
		    		</div>	
			        <div class="clearfix"></div>
					</div>
					<!-- end widget content -->
					
				</div>
				<!-- end widget div -->
				
			</div>
			
			<!-- end widget -->
    <!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget jarviswidget-color-light " id="wid-id-3" data-widget-editbutton="false" data-widget-colorbutton="true" data-widget-deletebutton="false" data-widget-fullscreenbutton="false">
				<!-- widget options:
					usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
					
					data-widget-colorbutton="false"	
					data-widget-editbutton="false"
					data-widget-togglebutton="false"
					data-widget-deletebutton="false"
					data-widget-fullscreenbutton="false"
					data-widget-custombutton="false"
					data-widget-collapsed="true" 
					data-widget-sortable="false"
					
				-->
				<header>
					<span class="widget-icon"><i class="fa fa-fw fa-bar-chart-o"> </i>  </span>
					<h2>PO Analytics by Dimensions</h2>				
					
				</header>

				<!-- widget div-->
				<div style="background:url('img/main-back.png') repeat scroll 0 0 #FFFFFF">
					
					<!-- widget edit box -->
					<div class="jarviswidget-editbox">
						<!-- This area used as dropdown edit box -->

					</div>
					<!-- end widget edit box -->
					
					<!-- widget content -->
					<div class="widget-body">
						
						<div id="pie-chart" class="col-md-4"  align="center">
				        <strong>Material Type</strong>
				        <a class="reset" href="javascript:pieChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>
				
				        <div class="clearfix"></div>
		    		</div>
		    		<div id="pie-chart-prchasegroup" class="col-md-4" align="center">
					        <strong>Purchase Group </strong>
					        <a class="reset" href="javascript:pieChartPurchaseGrp.filterAll();dc.redrawAll();" style="display: none;">reset</a>
					
					        <div class="clearfix"></div>
					   </div>
					   <div id="pie-chart-Companycode" class="col-md-4" align="center">
					        <strong>Company Code</strong>
					     <!--    <span class="reset" style="display: none;">range: <span class="filter"></span></span> -->
					        <a class="reset" href="javascript:pieChartCompanyCode.filterAll();dc.redrawAll();" style="display: none;">reset</a>
					
					        <div class="clearfix"></div>
					    </div>
						
					</div>
					<!-- end widget content -->
					
				</div>
				<!-- end widget div -->
				
			</div>
			<!-- end widget -->
</div>
</div>
 <div id="loading" style="left: 40%; position: absolute; top: 200px;"></div>  
		

          	
		
<div class="row">
<div class="col-md-12">
<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget jarviswidget-color-light " id="wid-id-4" data-widget-editbutton="false" data-widget-colorbutton="true" data-widget-deletebutton="false" data-widget-fullscreenbutton="false">
				<!-- widget options:
					usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
					
					data-widget-colorbutton="false"	
					data-widget-editbutton="false"
					data-widget-togglebutton="false"
					data-widget-deletebutton="false"
					data-widget-fullscreenbutton="false"
					data-widget-custombutton="false"
					data-widget-collapsed="true" 
					data-widget-sortable="false"
					
				-->
				<header>
					<span class="widget-icon"> <i class="fa fa-fw fa-bar-chart-o"> </i> </span>
					<h2>PO Count/Order Quantity by month</h2>				
					
				</header>

				<!-- widget div-->
				<div>
					
					<!-- widget edit box -->
					<div class="jarviswidget-editbox">
						<!-- This area used as dropdown edit box -->

					</div>
					<!-- end widget edit box -->
					
					<!-- widget content -->
					<div class="widget-body">
						
						<div class="row">
							<div id="timeline-area-chart">
					        
					        <span class="reset" style="display: none;">range: <span class="filter"></span></span>
					        <a class="reset" href="javascript:timelineAreaChart.filterAll();timelineChart.filterAll();dc.redrawAll();"
					           style="display: none;">reset</a>
					
					        <div class="clearfix"></div>
					    	</div>
				    	</div>
				    	<div class="row">
							<div id="timeline-chart"></div>
				    	</div>
				    	<div class="row" style="width: 900px;">
				    		<p class="muted pull-right">select a time range to zoom in</p>
				    	</div>
					</div>
					<!-- end widget content -->
					
				</div>
				<!-- end widget div -->
				
			</div>
			<!-- end widget -->

</div>
</div>   
         
<div class="row">
<div class="col-md-12">
<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget jarviswidget-color-light " id="wid-id-5" data-widget-editbutton="false"  data-widget-deletebutton="false" data-widget-fullscreenbutton="false">
				<!-- widget options:
					usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
					
					data-widget-colorbutton="false"	
					data-widget-editbutton="false"
					data-widget-togglebutton="false"
					data-widget-deletebutton="false"
					data-widget-fullscreenbutton="false"
					data-widget-custombutton="false"
					data-widget-collapsed="true" 
					data-widget-sortable="false"
					
				-->
				<header>
					<span class="widget-icon"><i class="fa fa-fw fa-bar-chart-o"> </i></span>
					<h2>Detail view</h2>				
					
				</header>

				<!-- widget div-->
				<div>
					
					<!-- widget edit box -->
					<div class="jarviswidget-editbox">
						<!-- This area used as dropdown edit box -->

					</div>
					<!-- end widget edit box -->
					
					<!-- widget content -->
					<div class="widget-body">
						
						
						<div class="row" style="overflow-x: scroll;">
						    <div>
						        <div class="dc-data-count">
						            <span class="filter-count"></span> selected out of <span class="total-count"></span> records | <a
						                href="javascript:dc.filterAll(); dc.renderAll();">Reset All</a>
						        </div>
						    </div>
						    <table class="table table-hover dc-data-table">
						        <thead>
						        <tr class="header">
						            <th>Date</th>
						            <th>PO Count</th>
						            <th>Company Code</th>
						            <th>Purchase Org</th>
						            <th>Purchase Group</th>
						            <th>Plant Group</th>
						            <th>Vendor Type</th>
						            <th>Order Quantity</th>
						            <th>Net Price</th>
						            <th>Material Type</th>
						            <th>Gross Value</th>
						            <th>Source</th>
						            <th>PO Type</th>
						            <th>Last Changed On</th>
						            
						        </tr>
						        </thead>
						    </table>
						</div>
						
						
						
					<!-- end widget content -->
					
				</div>
				<!-- end widget div -->
				
			</div>
			<!-- end widget -->

</div>
</div>              
</div>            
</article>
</div> 
</section>
<!-- end widget grid -->

<script type="text/javascript">
	
	// DO NOT REMOVE : GLOBAL FUNCTIONS!
	pageSetUp();
	
	// PAGE RELATED SCRIPTS

	// switch style change
	$('input[name="checkbox-style"]').change(function() {
		//alert($(this).val())
		$this = $(this);

		if ($this.attr('value') === "switch-1") {
			$("#switch-1").show();
			$("#switch-2").hide();
		} else if ($this.attr('value') === "switch-2") {
			$("#switch-1").hide();
			$("#switch-2").show();
		}

	}); 
	
	// tab - pills toggle
	$('#show-tabs').click(function() {
		$this = $(this);
		if($this.prop('checked')){
			$("#widget-tab-1").removeClass("nav-pills").addClass("nav-tabs");
		} else {
			$("#widget-tab-1").removeClass("nav-tabs").addClass("nav-pills");
		}
		
	});	
</script>

    <script type="text/javascript" src="js/crossfilter.js"></script>
    <script type="text/javascript" src="js/dc.js"></script>
    <script type="text/javascript" src="js/colorbrewer.js"></script>

<script type="text/javascript">
$('#loading').show();
//# dc.js Getting Started and How-To Guide
'use strict';

/* jshint globalstrict: true */
/* global dc,d3,crossfilter,colorbrewer */

// ### Create Chart Objects
// Create chart objects assocated with the container elements identified by the css selector.
// Note: It is often a good idea to have these objects accessible at the global scope so that they can be modified or filtered by other page controls.
// var gainOrLossChart = dc.pieChart("#gain-loss-chart");
// var fluctuationChart = dc.barChart("#fluctuation-chart");
var pieChart = dc.pieChart("#pie-chart");
var pieChartVendor= dc.pieChart("#pie-chart-Vendor");
var pieChartCompanyCode= dc.pieChart("#pie-chart-Companycode");
var pieChartPurchaseGrp= dc.pieChart("#pie-chart-prchasegroup");
var pieChartPlant= dc.pieChart("#pie-chart-plant");
var pieChartPurchaseorg= dc.pieChart("#pie-chart-purchaseorg");

var horzBarChart = dc.rowChart("#row-chart");
// var yearlyBubbleChart = dc.bubbleChart("#yearly-bubble-chart");
var timelineAreaChart = dc.lineChart("#timeline-area-chart");
var timelineChart = dc.barChart("#timeline-chart");
// ### Anchor Div for Charts
/*
// A div anchor that can be identified by id
    <div id="your-chart"></div>
// Title or anything you want to add above the chart
    <div id="chart"><span>Days by Gain or Loss</span></div>
// ##### .turnOnControls()
// If a link with css class "reset" is present then the chart
// will automatically turn it on/off based on whether there is filter
// set on this chart (slice selection for pie chart and brush
// selection for bar chart). Enable this with `chart.turnOnControls(true)`
     <div id="chart">
       <a class="reset" href="javascript:myChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>
     </div>
// dc.js will also automatically inject applied current filter value into
// any html element with css class set to "filter"
    <div id="chart">
        <span class="reset" style="display: none;">Current filter: <span class="filter"></span></span>
    </div>
*/

//### Load your data
//Data can be loaded through regular means with your
//favorite javascript library
//
//```javascript
//d3.csv("data.csv", function(data) {...};
//d3.json("data.json", function(data) {...};
//jQuery.getJson("data.json", function(data){...});
//```
//var request = {};
//callAjaxService("dropship",request,function(){alert("ok")},function(){alert("ok1")},"GET","CSV");

    d3.csv("../rest/profiling/dropship", function (data) {
	   console.log(data);
	   $('#loading').hide();
		//console.debug(data);
		//alert(3);
	    /* since its a csv file we need to format the data a bit */
	    //var dateFormat = d3.time.format("%Y.%m.%d");
	    var dateFormat = d3.time.format("%m/%d/%Y");
	  
	    var numberFormat = d3.format(".2f");

	    var numberFormat2 = d3.format(",.2f");

	    var numberFormat3 = d3.format("");

	    /*var xd = "2008.08.01";
	    var xf = dateFormat.parse(xd);
	    alert(xd);
	    alert(d3.time.month(xf).getMonth());*/
	var flag = 1;
	    
	    data.forEach(function (d) {
	    	//console.debug(d);
	    	
	    //	console.debug(dateFormat.parse(d.lastchangedon));
	    //	console.debug(dateFormat.parse("2008.08.01"));
	    
	        d.dd = dateFormat.parse(d.lastchangedon);
	      
	        d.month = d3.time.month(d.dd); // pre-calculate month for better performance
	        //d.year = d3.time.year(d.dd);
	        //d.close = +d.close; // coerce to number
	        //d.open = +d.open;
	        d.po_count = +d.po_count;
	        d.orderquantity = +d.orderquantity;
	        d.grossordervalue = +d.grossordervalue;
	        d.netprice = +d.netprice;

	        /*test code to see nth record
	        if (flag == 100)
	            {
	            alert(d.month);
	            alert(d.dd);
	            alert(d3.time.year(d.dd));
	            
	            }
	       flag++;*/
	   });

	    //### Create Crossfilter Dimensions and Groups
	    //See the [crossfilter API](https://github.com/square/crossfilter/wiki/API-Reference) for reference.
	    var ndx = crossfilter(data);
	  
	    var all = ndx.groupAll();

	    

	    
	    // dimension by full date
	    var dataTableDimension = ndx.dimension(function (d) {
	    	return d.dd;
	    });

	 

	    // dimension by month
	    var timelineDimension = ndx.dimension(function (d) {
	    	//console.debug(d.month);
	        return d.month;
	    });
	    // group by total volume within move, and scale down result
	    var timelineGroup = timelineDimension.group().reduceSum(function (d) {
	        return d.orderquantity
	         
	    });
	    // group by total movement within month
	    var timelineSecondGroup = timelineDimension.group().reduceSum(function (d) {
	        return d.po_count;
	    });
	    var timelineAreaGroup = timelineDimension.group().reduce(
	        function (p, v) {
	            ++p.count;
	            p.total += v.netprice;//(v.open + v.close) / 2;
	            p.avg = Math.round(p.total / p.count);

	            if ('M'+v.materialid in p.materialMap)
	                {
	            		p.materialMap['M'+v.materialid]++;
	                }
	            else
	                {
	            		p.materialMap['M'+v.materialid] = 1;
	                }
	            p.avg = p.materialMap.length;

	            if ('V'+v.vendor in p.vendorMap)
	            {
	        		p.vendorMap['V'+v.vendor]++;
	            }
		        else
		            {
		        		p.vendorMap['V'+v.vendor] = 1;
		            }
		        p.total = p.vendorMap.length;
	            
	            return p;
	        },
	        function (p, v) {
	            --p.count;
	            p.total -= v.netprice;//(v.open + v.close) / 2;
	            p.avg = p.count ? Math.round(p.total / p.count) : 0;

	            if ('M'+v.materialid in p.materialMap)
	            {
	                if (p.materialMap['M'+v.materialid] == 1)
	                	delete p.materialMap['M'+v.materialid];
	                else
	        			p.materialMap['M'+v.materialid]--;
	            }
	        	p.avg = p.materialMap.length;

	        	if ('V'+v.vendor in p.vendorMap)
	            {
	                if (p.vendorMap['V'+v.vendor] == 1)
	                	delete p.materialMap['V'+v.vendor];
	                else
	        			p.vendorMap['V'+v.vendor]--;
	            }
	        	p.total = p.vendorMap.length;
	        	            
	            return p;
	        },
	        function () {
	            return {count: 0, total: 0, avg: 0, materialMap:[], vendorMap:[]};
	        }
	    );

	    
	  
	    
	    // summerize volume by quarter
	    var pieGroupDimension = ndx.dimension(function (d) {
	            return d.material_type;
	    });
	    var pieChartVendorGroupDimention =ndx.dimension(function (d) {
	            return d.vendor_type;
	    });
	    var pieChartCompanyGroupDimention =ndx.dimension(function (d) {
	        return d.companycode;
		});
	    var pieChartPurchaseGroupDimention =ndx.dimension(function (d) {
	        return d.purchasegroup;
		});
	    var pieChartPlantDimention =ndx.dimension(function (d) {
	        return d.plantgroup;
		});
	    var pieChartPurchaseorgDimention =ndx.dimension(function (d) {
	        return d.purchaseorg;
		});
	    
	    
	    var pieGroup = pieGroupDimension.group().reduceSum(function (d) {
	        return d.po_count;
	    });
	    var pieVendorGroup = pieChartVendorGroupDimention.group().reduceSum(function (d) {
	        return d.po_count;
	    });
	    var pieCompanyGroup = pieChartCompanyGroupDimention.group().reduceSum(function (d) {
	        return d.po_count;
	    });
	    var piePurchaseGroup = pieChartPurchaseGroupDimention.group().reduceSum(function (d) {
	        return d.po_count;
	    });
	    var piePlantGroup = pieChartPlantDimention.group().reduceSum(function (d) {
	        return d.po_count;
	    });
	    var piePurchaseOrgGroup = pieChartPurchaseorgDimention.group().reduceSum(function (d) {
	        return d.po_count;
	    });
	    
	    // counts per weekday
	    var horzBarDimension = ndx.dimension(function (d) {
	   
	        //var day = d.dd.getDay();
	        //var name=["None","Drop-ship","Sub-Contracting","Ext-Process","Kitting","Cold chain","Other"];
	        //return day+"."+name[day];
	        return d.po_type;
	     });
	    var horzBarGrp = horzBarDimension.group();

	    //### Define Chart Attributes
	    //Define chart attributes using fluent methods. See the [dc API Reference](https://github.com/dc-js/dc.js/blob/master/web/docs/api-1.7.0.md) for more information
	    //
		
	   
	    //#### Stacked Area Chart
	    //Specify an area chart, by using a line chart with `.renderArea(true)`
	  
	    // For doNut chart comment inner radius
	    var colorScale = d3.scale.ordinal().range(['#000']);
	    pieChart.width(250)
	        .height(200)
	        .radius(80)
	       // .innerRadius(30)
	        .dimension(pieGroupDimension)
	        .group(pieGroup);
	    
	    pieChartVendor.width(250)
	    .height(200)
	    .radius(80)
	    .innerRadius(40)
	    .dimension(pieChartVendorGroupDimention)
	    .group(pieVendorGroup);
	    
	    pieChartCompanyCode.width(250)
	    .height(200)
	    .radius(80)
	    .colors(colorScale)
	  //  .innerRadius(30)
	    .dimension(pieChartCompanyGroupDimention)
	    .group(pieCompanyGroup);
	    
	    pieChartPurchaseGrp.width(250)
	    .height(200)
	    .radius(80)
	   .innerRadius(40)
	    .dimension(pieChartPurchaseGroupDimention)
	    .group(piePurchaseGroup);
	    
	    pieChartPlant.width(250)
	    .height(200)
	    .radius(80)
	  //  .innerRadius(30)
	    .dimension(pieChartPlantDimention)
	    .group(piePlantGroup);
	    
	    
	    pieChartPurchaseorg.width(250)
	    .height(200)
	    .radius(80)
	   .innerRadius(40)
	    .dimension(pieChartPurchaseorgDimention)
	    .group(piePurchaseOrgGroup);
	    
	    
	    //#### Row Chart
	    horzBarChart.width(180)
	        .height(480)
	        .margins({top: 20, left: 10, right: 10, bottom: 20})
	        .group(horzBarGrp)
	        .dimension(horzBarDimension)
	        // assign colors to each value in the x scale domain
	        .ordinalColors(['#3182bd', '#6baed6', '#9e5ae1', '#c64bef', '#da8aab'])
	        .label(function (d) {
	        	
	            return d.key;//.split(".")[1];
	        })
	        // title sets the row text
	        .title(function (d) {
	            return d.key + ': ' + d.value;//d.value;
	        })
	        .elasticX(true)
	        .xAxis().ticks(4);

	   

	    timelineAreaChart
	    .renderArea(true)
	    .width(900)
	    .height(150)
	    .transitionDuration(1000)
	    .margins({top: 30, right: 0, bottom: 25, left: 80})
	    .dimension(timelineDimension)
	    .mouseZoomable(true)
	    // Specify a range chart to link the brush extent of the range with the zoom focue of the current chart.
	    .rangeChart(timelineChart)
	    .x(d3.time.scale().domain([new Date(2011, 0, 1), new Date(2015, 11, 31)]))
	    .round(d3.time.month.round)
	    .xUnits(d3.time.months)
	    .elasticY(true)
	    .renderHorizontalGridLines(true)
	  //  .legend(dc.legend().x(800).y(10).itemHeight(13).gap(5))
	    .brushOn(false)
	    // Add the base layer of the stack with group. The second parameter specifies a series name for use in the legend
	    // The `.valueAccessor` will be used for the base layer
	    .group(timelineAreaGroup, "Vendor Count")
	    .valueAccessor(function (d) {
	        return d.value.total;
	    })
	    // stack additional layers with `.stack`. The first paramenter is a new group.
	    // The second parameter is the series name. The third is a value accessor.
	    .stack(timelineSecondGroup, "Material Count", function (d) {
	        return d.value;
	    })
	    // title can be called by any stack layer.
	    .title(function (d) {
	        var value = d.value.avg ? d.value.avg : d.value;
	        if (isNaN(value)) value = 0;
	        return dateFormat(d.key) + "\n" + numberFormat(value);
	    });

	timelineChart.width(900)
	    .height(80)
	    .margins({top: 40, right: 0, bottom: 20, left: 80})
	    .dimension(timelineDimension)
	    .group(timelineGroup)
	    .centerBar(true)
	    .gap(1)
	    .x(d3.time.scale().domain([new Date(2011, 0, 1), new Date(2015, 11, 31)]))
	     .round(d3.time.month.round)
	    .alwaysUseRounding(true)
	    .xUnits(d3.time.months);


	    //#### Data Count
	    // Create a data count widget and use the given css selector as anchor. You can also specify
	    // an optional chart group for this chart to be scoped within. When a chart belongs
	    // to a specific group then any interaction with such chart will only trigger redraw
	    // on other charts within the same chart group.

	    dc.dataCount(".dc-data-count")
	        .dimension(ndx)
	        .group(all);

	    dc.dataTable(".dc-data-table")
	        .dimension(dataTableDimension)
	        // data table does not use crossfilter group but rather a closure
	        // as a grouping function
	        .group(function (d) {
	      
	        	 var format = d3.format("02d");
	             return d.dd.getFullYear() + "/" + format((d.dd.getMonth() + 1));
	        })
	        .size(50) // (optional) max number of records to be shown, :default = 25
	        // dynamic columns creation using an array of closures
	        .columns([
	            function (d) {
	            	return d.date;
	            },
	            function (d) {
	                return numberFormat3(d.po_count);
	            },
	            function (d) {
	                return d.companycode;
	            },
	            function (d) {
	                return d.purchaseorg;
	            },
	            function (d) {
	                return d.purchasegroup;
	            },
	            function (d) {
	                return d.plantgroup;
	            },
	            function (d) {
	                return d.vendor_type;
	            },
	            function (d) {
	                return d.orderquantity;
	            },
	            function (d) {
	                return numberFormat2(d.netprice);
	            },
	            function (d) {
	                return d.material_type;
	            },
	            function (d) {
	                return numberFormat2(d.grossordervalue);
	            },
	            function (d) {
	                return d.source;
	            },
	            function (d) {
	                return d.po_type;
	            },
	            function (d) {
	                return d.lastchangedon;
	            }
	        ])
	        // (optional) sort using the given field, :default = function(d){return d;}
	        .sortBy(function (d) {
	            return d.dd;
	        })
	        // (optional) sort order, :default ascending
	        .order(d3.ascending)
	        // (optional) custom renderlet to post-process chart using D3
	        .renderlet(function (table) {
	            table.selectAll(".dc-table-group").classed("info", true);
	        });
	 

	    /*
	    //#### Geo Choropleth Chart
	    //Create a choropleth chart and use the given css selector as anchor. You can also specify
	    //an optional chart group for this chart to be scoped within. When a chart belongs
	    //to a specific group then any interaction with such chart will only trigger redraw
	    //on other charts within the same chart group.
	    dc.geoChoroplethChart("#us-chart")
	        .width(990) // (optional) define chart width, :default = 200
	        .height(500) // (optional) define chart height, :default = 200
	        .transitionDuration(1000) // (optional) define chart transition duration, :default = 1000
	        .dimension(states) // set crossfilter dimension, dimension key should match the name retrieved in geo json layer
	        .group(stateRaisedSum) // set crossfilter group
	        // (optional) define color function or array for bubbles
	        .colors(["#ccc", "#E2F2FF","#C4E4FF","#9ED2FF","#81C5FF","#6BBAFF","#51AEFF","#36A2FF","#1E96FF","#0089FF","#0061B5"])
	        // (optional) define color domain to match your data domain if you want to bind data or color
	        .colorDomain([-5, 200])
	        // (optional) define color value accessor
	        .colorAccessor(function(d, i){return d.value;})
	        // Project the given geojson. You can call this function mutliple times with different geojson feed to generate
	        // multiple layers of geo paths.
	        //
	        // * 1st param - geo json data
	        // * 2nd param - name of the layer which will be used to generate css class
	        // * 3rd param - (optional) a function used to generate key for geo path, it should match the dimension key
	        // in order for the coloring to work properly
	        .overlayGeoJson(statesJson.features, "state", function(d) {
	            return d.properties.name;
	        })
	        // (optional) closure to generate title for path, :default = d.key + ": " + d.value
	        .title(function(d) {
	            return "State: " + d.key + "\nTotal Amount Raised: " + numberFormat(d.value ? d.value : 0) + "M";
	        });

	        //#### Bubble Overlay Chart
	        // Create a overlay bubble chart and use the given css selector as anchor. You can also specify
	        // an optional chart group for this chart to be scoped within. When a chart belongs
	        // to a specific group then any interaction with such chart will only trigger redraw
	        // on other charts within the same chart group.
	        dc.bubbleOverlay("#bubble-overlay")
	            // bubble overlay chart does not generate it's own svg element but rather resue an existing
	            // svg to generate it's overlay layer
	            .svg(d3.select("#bubble-overlay svg"))
	            .width(990) // (optional) define chart width, :default = 200
	            .height(500) // (optional) define chart height, :default = 200
	            .transitionDuration(1000) // (optional) define chart transition duration, :default = 1000
	            .dimension(states) // set crossfilter dimension, dimension key should match the name retrieved in geo json layer
	            .group(stateRaisedSum) // set crossfilter group
	            // closure used to retrieve x value from multi-value group
	            .keyAccessor(function(p) {return p.value.absGain;})
	            // closure used to retrieve y value from multi-value group
	            .valueAccessor(function(p) {return p.value.yAxisVariancePercentage;})
	            // (optional) define color function or array for bubbles
	            .colors(["#ccc", "#E2F2FF","#C4E4FF","#9ED2FF","#81C5FF","#6BBAFF","#51AEFF","#36A2FF","#1E96FF","#0089FF","#0061B5"])
	            // (optional) define color domain to match your data domain if you want to bind data or color
	            .colorDomain([-5, 200])
	            // (optional) define color value accessor
	            .colorAccessor(function(d, i){return d.value;})
	            // closure used to retrieve radius value from multi-value group
	            .radiusValueAccessor(function(p) {return p.value.xAxisVariancePercentage;})
	            // set radius scale
	            .r(d3.scale.linear().domain([0, 3]))
	            // (optional) whether chart should render labels, :default = true
	            .renderLabel(true)
	            // (optional) closure to generate label per bubble, :default = group.key
	            .label(function(p) {return p.key.getFullYear();})
	            // (optional) whether chart should render titles, :default = false
	            .renderTitle(true)
	            // (optional) closure to generate title per bubble, :default = d.key + ": " + d.value
	            .title(function(d) {
	                return "Title: " + d.key;
	            })
	            // add data point to it's layer dimension key that matches point name will be used to
	            // generate bubble. multiple data points can be added to bubble overlay to generate
	            // multiple bubbles
	            .point("California", 100, 120)
	            .point("Colorado", 300, 120)
	            // (optional) setting debug flag to true will generate a transparent layer on top of
	            // bubble overlay which can be used to obtain relative x,y coordinate for specific
	            // data point, :default = false
	            .debug(true);
	    */

	    //#### Rendering
	    //simply call renderAll() to render all charts on the page
	    dc.renderAll();
	    /*
	    // or you can render charts belong to a specific chart group
	    dc.renderAll("group");
	    // once rendered you can call redrawAll to update charts incrementally when data
	    // change without re-rendering everything
	    dc.redrawAll();
	    // or you can choose to redraw only those charts associated with a specific chart group
	    dc.redrawAll("group");
	    */
	   });


//#### Version
//Determine the current version of dc with `dc.version`
d3.selectAll("#version").text(dc.version);

var opts = {
		  lines: 15, // The number of lines to draw
		  length: 8, // The length of each line
		  width: 5, // The line thickness
		  radius: 12, // The radius of the inner circle
		  corners: 0.7, // Corner roundness (0..1)
		  rotate: 0, // The rotation offset 
		  direction: 1, // 1: clockwise, -1: counterclockwise
		  color: '#000', // #rgb or #rrggbb or array of colors
		  speed: 1, // Rounds per second
		  trail: 60, // Afterglow percentage
		  shadow: false, // Whether to render a shadow
		  hwaccel: false, // Whether to use hardware acceleration
		  className: 'spinner', // The CSS class to assign to the spinner
		  zIndex: 2e9, // The z-index (defaults to 2000000000)
		  top: '10', // Top position relative to parent in px
		  left: 'auto' // Left position relative to parent in px
		};
		var target = document.getElementById('loading');
		var spinner = new Spinner(opts).spin(target);

</script>